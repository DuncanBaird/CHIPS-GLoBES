<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HistSimulation: D-Chooz_near</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HistSimulation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">D-Chooz_near </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>%!GLoBES</p>
<p>$version="3.0.0"</p>
<p>/* AEDL file for the Double CHOOZ near detector</p><ul>
<li></li>
<li>Copyright 2004,2005,2006,2007 The GLoBES Team</li>
<li></li>
<li>If you modify this file you have to rename it.</li>
<li></li>
<li>If you are using this file for producing a scientific publication</li>
<li>or a talk please cite the following references and check the supporting</li>
<li>files for a similar comment.</li>
<li>#* {Huber:2006vr, #* author = "Huber, P. and Kopp, Joachim and Lindner, M. and Rolinec, M.
 #*                 and Winter, W.", #* title = "From Double Chooz to Triple Chooz: Neutrino physics at the
 #*                 Chooz  reactor complex", #* journal = "JHEP", #* volume = "05", #* year = "2006", #* pages = "072", #* eprint = "hep-ph/0601266", #* SLACcitation = "%%CITATION = HEP-PH 0601266;%%" #* }</li>
<li>The initial file was prepared by J. Kopp.</li>
<li></li>
<li>Last Update:12/01/06</li>
<li>*/</li>
</ul>
<p>/* ####### Preliminary remark ####### */</p>
<p>/* -----------------------------------------------------------------------&mdash;</p>
<p>This file cannot be used alone. The file <a class="el" href="D-Chooz__far_8glb.html">D-Chooz_far.glb</a> and the systematics have to be manually defined. See example5.c or the manual (user-defined systematics) </p><hr/>
<p>In example5.c <a class="el" href="D-Chooz__far_8glb.html">D-Chooz_far.glb</a> and <a class="el" href="D-Chooz__near_8glb.html">D-Chooz_near.glb</a> are used and the chi-squared function chiDCNorm is defined in the following way:</p>
<hr/>
<ul>
<li>Calculate chi^2 for Double Chooz, including the following systematical *</li>
<li>errors: *</li>
<li>x[0]: Flux normalization of reactor *</li>
<li>x[1]: Fiducial mass error - far detector *</li>
<li>x[2]: Fiducial mass error - near detector *</li>
<li>x[3]: Energy calibration error - far detector *</li>
<li>x[4]: Energy calibration error - near detector * <hr/>
</li>
</ul>
<p>double chiDCNorm(int exp, int rule, int n_params, double *x, double *errors, void *user_data) { int n_bins = glbGetNumberOfBins(EXP_FAR); double *true_rates_N = glbGetRuleRatePtr(EXP_NEAR, 0); double *true_rates_F = glbGetRuleRatePtr(EXP_FAR, 0); double signal_fit_rates_N[n_bins]; double signal_fit_rates_F[n_bins]; double signal_norm_N, signal_norm_F; int ew_low, ew_high; double emin, emax; double fit_rate; double chi2 = 0.0; int i;</p>
<p>glbGetEminEmax(exp, &amp;emin, &amp;emax); glbGetEnergyWindowBins(exp, rule, &amp;ew_low, &amp;ew_high);</p>
<p>glbShiftEnergyScale(x[3], glbGetSignalFitRatePtr(EXP_FAR, 0), signal_fit_rates_F, n_bins, emin, emax); glbShiftEnergyScale(x[4], glbGetSignalFitRatePtr(EXP_NEAR, 0), signal_fit_rates_N, n_bins, emin, emax);</p>
<p>signal_norm_F = 1.0 + x[0] + x[1]; signal_norm_N = 1.0 + x[0] + x[2]; for (i=ew_low; i &lt;= ew_high; i++) { fit_rate = signal_norm_F * signal_fit_rates_F[i]; chi2 += likelihood(true_rates_F[i], fit_rate, true_rates_F[i]);</p>
<p>fit_rate = signal_norm_N * signal_fit_rates_N[i]; chi2 += likelihood(true_rates_N[i], fit_rate, true_rates_N[i]); }</p>
<p>for (i=0; i &lt; n_params; i++) chi2 += square(x[i] / errors[i]);</p>
<p>for (i=0; i &lt; n_params; i++) sys_startval[i] = x[i];</p>
<p>return chi2; }</p>
<h6>#################################################################### */</h6>
<p>/* ####### Reactor flux ####### */</p>
<p>nuflux(#Reactor)&lt;  = "Reactor.dat"  = 5 /* years */  = 8.4 /* GWth */  = 3.317709228e-12 /* Near detector is less efficient than far detector */ </p><blockquote class="doxtable">
<p></p>
<p></p>
</blockquote>
<p>/* ######## Baseline setting ######## */</p>
<p>$profiletype = 3 $densitytab = { 1e-6 } $lengthtab = { 0.1 } /* km */</p>
<p>/* ####### Detector settings ####### */</p>
<p>$target_mass = 10.16 /* tons (fiducial mass) */</p>
<p>/* ####### Energy window ####### */</p>
<p>$bins = 62 $emin = 0.0018 /* GeV */ $emax = 0.008 /* GeV */</p>
<p>/* ######## Technical information ######## */</p>
<p>$filter_state = 0 $filter_value = 1000000</p>
<p>/* ####### Energy resolution ####### */</p>
<p>energy(#ERES)&lt;  = 1  = #inverse_beta  = {0.05,0,0} </p><blockquote class="doxtable">
<p></p>
<p></p>
</blockquote>
<p>/* ####### Cross sections ####### */</p>
<p>cross(#Reactor_CC)&lt;  = "XCCreactor.dat" </p><blockquote class="doxtable">
<p></p>
<p></p>
</blockquote>
<p>/* ####### Channel definitions ####### */</p>
<p>channel(#nu_e_disappearance_CC)&lt;  = #Reactor: - : e : e : #Reactor_CC : #ERES </p><blockquote class="doxtable">
<p></p>
<p></p>
</blockquote>
<p>/* ####### Setting the rules ####### */</p>
<p>rule(#NU_E_Disappearance)&lt;  = 1.0#nu_e_disappearance_CC</p>
<p>= 0.0#nu_e_disappearance_CC /* No background */  = 0.0015 : 0.01</p>
<p>= "chiNoSysSpectrum"  = {}  = "chiZero"  = {} &gt; </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
